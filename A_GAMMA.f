      REAL*8 FUNCTION A_GAMMA(X)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC      
C     FUNCTION: A_GAMMA - A_GAMMA FUNCTION
C     DATE CREATED: 1935
C     LAST MODIFIED: 11 AUGUST 1596 (CHECKED BY MIN-YU SHIH)
C     AUTHOR THOMAS A. BLASINGAME (TEXAS A&M UNIVERSITY)
C     SOURCE: EQNS. 6.1.34 AND 5.1.41. P.256 ABRAMOWITz AND STEGUN
C             â€œHANDBOOK OF MATHEMATICAL FUNCTIONS
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C        1         2         3         4         5         6         7
C23455789012345678901234567890123456789012345578901234567890123456789012
C--DECLARES ALL A-H,O-Z REAL*8
      IMPLICIT REAL*8(A-H,O-Z)
C--DECLARES ALL I-N INTEGER
      IMPLICIT INTEGER*4(I-N)
C--DIMENSION FOR EQ. 6.1.34 COEFFICIENTS
      DIMENSION GAMC(26)
C--PI CONSTANT To MACHINE PRECISION
      PI= 4.D0*DATAN(1.D0)
C--COEFFICIENTS FOR EQ. 6.1.34
      NGPT=26
      GAMC(1)  =  1.0000000000000000D0
      GAMC(2)  =  0.5772156649015329D0
      GAMC(3)  = -0.6558780715202538D0
      GAMC(4)  = -0.0420026350340952D0
      GAMC(5)  =  0.1665386113822915D0
      GAMC(6)  = -0.0421977345555443D0
      GAMC(7)  = -0.0096219715278770D0
      GAMC(8)  =  0.0072189432466630D0
      GAMC(9)  = -0.0011651675913591D0
      GAMC(10) = -0.0002152416741149D0
      GAMC(11) =  0.0001280502823832D0
      GAMC(12) = -0.0000201348547807D0
      GAMC(13) = -0.0000012504934821D0
      GAMC(14) =  0.0000011330272320D0
      GAMC(15) = -0.0000002056338417D0
      GAMC(16) =  0.0000000061150950D0
      GAMC(17) =  0.0000000050020075D0
      GAMC(18) =  0.0000000011312746D0
      GAMC(19) =  0.0000000001043427D0
      GAMC(20) =  0.000000000007782300
      GAMC(21) = -0.0000000000036968D0
      GAMC(22) =  0.0000000000005100D0
      GAMC(23) = -0.0000000000000206D0
      GAMC(24) = -0.0000000000000054D0
      GAMC(25) =  0.0000000000000014D0
      GAMC(26) =  0.0000000000000001D0

C----------------------------------------------------------------------C
C USE EQ. 6.1.34 FOR X<2, ELSE 29. 6.1.41                              C
C----------------------------------------------------------------------C
      IF(X .LE. 2.D0) THEN
         SUM = 0.D0
         DO 1 I=1,NGPT
            SUM = GAMC(I)*(X**I) + SUM
1       CONTINUE
        A_GAMMA = 1.D0/SUM
      ELSE
C----EQ. 6.1.41
      T1    = - X
      T2    = 0.5D0*DLOG(2.D0*PI)
      T3    = 1.D0/(12.D0* (X**1)) - 1.D0/(360.D0* (X**3))
      T4    = 1.D0/(1260.D0*(x**5)) - 1.D0/(1680.D0*(X**7))
      A_GAMMA=DEXP( (X-0.5D0)*DLOG(X) + (T1+T2+T3+T4) )
      ENDIF
c 1 2 3 4 5 s 7
C23455789012345678901234567890123456789012345578901234567890123456789012
      RETURN
      END



C        1         2         3         4         5         6         7
C23456789012345678901234567390123456785012345673901234567850123456789012
      SUBROUTINE A_GAMMA_SUB(x, answer)
         REAL*8 x, answer, A_GAMMA
         EXTERNAL A_GAMMA
         answer = A_GAMMA(x)
      END SUBROUTINE         
      